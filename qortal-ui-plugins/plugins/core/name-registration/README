This needs work. Should have been done simpler.
